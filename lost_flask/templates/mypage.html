<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>„Éû„Ç§„Éö„Éº„Ç∏ - „Éó„É≠„Éï„Ç£„Éº„É´Á∑®ÈõÜ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=12">
    <style>
        /* „Éû„Ç§„Éö„Éº„Ç∏Â∞ÇÁî®„Çπ„Çø„Ç§„É´ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
                align-items: start;
            }
        }

        .stats-row {
            display: flex;
            justify-content: space-around;
            background: #fff;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            margin-bottom: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            display: block;
            font-size: 1.8em;
            font-weight: 800;
            color: var(--primary-color);
            line-height: 1.2;
        }
        
        .stat-label {
            font-size: 0.85em;
            color: var(--text-sub);
            font-weight: 600;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: var(--text-main);
            font-weight: 800;
            font-size: 1.2em;
        }
        .section-header::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 24px;
            background: var(--primary-color);
            margin-right: 10px;
            border-radius: 3px;
        }

        .profile-form-box {
            background: #fff;
            padding: 30px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        @media (min-width: 600px) {
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="{{ url_for('index') }}">
        <img src="{{ url_for('static', filename='Blueonly.png') }}" alt="Â§ßÂ≠¶„É≠„Ç¥" id="logo-banner">
    </a>

    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <div class="user-header">
        <a href="{{ url_for('swipe_page') }}" class="header-action-btn">
            ‚ö° È´òÈÄü„É¨„Éì„É•„Éº
        </a>

        <div class="dropdown" tabindex="0">
            <div class="dropbtn">
                <span>{{ current_user.username }} „Åï„Çì</span>
                <span style="font-size: 0.8em; margin-left: 5px;">‚ñº</span>
            </div>
            <div class="dropdown-content">
                <a href="{{ url_for('mypage') }}">üë§ „Éû„Ç§„Éö„Éº„Ç∏</a>
                <a href="{{ url_for('my_favorites') }}">üíñ „ÅäÊ∞ó„Å´ÂÖ•„ÇäË¨õÁæ©</a>
                <a href="{{ url_for('help_page') }}">‚ùì ‰Ωø„ÅÑÊñπ</a>
                <a href="{{ url_for('logout') }}" class="logout-item">üö™ „É≠„Ç∞„Ç¢„Ç¶„Éà</a>
            </div>
        </div>
    </div>

    <div class="container">
        <header class="main-header">
            <h1 class="app-title">„Éû„Ç§„Éö„Éº„Ç∏</h1>
        </header>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
              {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
              {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- ‚ñº‚ñº‚ñº 1. „Çπ„ÉÜ„Éº„Çø„Çπ„Éª„É©„É≥„ÇØ„Ç®„É™„Ç¢ (2„Ç´„É©„É†) ‚ñº‚ñº‚ñº -->
        <div class="dashboard-grid">
            <!-- Â∑¶: „É©„É≥„ÇØ„Ç´„Éº„Éâ -->
            <div>
                <div class="section-header">ÁèæÂú®„ÅÆ„É©„É≥„ÇØ</div>
                {% set level_info = user.get_level_info() %}
                <div class="level-card {{ level_info.style_class }}" style="margin-bottom: 0; height: 100%; box-sizing: border-box;">
                    <div class="level-header">
                        <div class="level-icon-large">{{ level_info.icon }}</div>
                        <div class="level-info">
                            <h3>Reviewer Rank</h3>
                            <div class="level-rank-title">{{ level_info.title }} <span style="font-size:0.6em; font-weight:normal; color:#666;">(Lv.{{ level_info.level }})</span></div>
                        </div>
                    </div>
                    <div class="level-desc">{{ level_info.desc }}</div>
                    {% if level_info.next_goal %}
                    <div class="level-progress-area">
                        <div class="level-progress-text">
                            <span>Ê¨°„ÅÆ„É©„É≥„ÇØ„Åæ„Åß</span>
                            <span>„ÅÇ„Å® <strong>{{ level_info.next_goal }}</strong> ‰ª∂</span>
                        </div>
                    </div>
                    {% else %}
                    <div class="level-progress-area">
                        <div class="level-progress-text" style="justify-content:center; color:var(--warning-color);">
                            <span>üéâ ÊúÄÈ´ò„É©„É≥„ÇØ„Å´Âà∞ÈÅîÔºÅ</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Âè≥: Èñ≤Ë¶ßÊ®©Èôê & „ÇØ„É¨„Ç∏„ÉÉ„ÉàÁÆ°ÁêÜÔºàÁµ±ÂêàÔºâ -->
            <div style="display: flex; flex-direction: column; height: 100%;">
                <div class="section-header">Èñ≤Ë¶ßÊ®©Èôê & „ÇØ„É¨„Ç∏„ÉÉ„Éà</div>
                
                <div class="access-status-card {{ access_status.class if access_status else '' }}" style="flex: 1; margin-bottom: 20px; display: flex; flex-direction: column; justify-content: center; text-align: center;">
                    
                    {% if access_status %}
                        <h3>{{ access_status.label }}</h3>
                        
                        {% if access_status.description %}
                            <p class="access-status-desc">{{ access_status.description | safe }}</p>
                        {% endif %}

                        {% if access_status.type == 'locked' %}
                            <p class="text-danger mt-2" style="font-weight: bold; color: #ef4444; margin-bottom: 10px;">
                                <span style="margin-right: 5px;">üîí</span> Èñ≤Ë¶ßÂà∂Èôê‰∏≠
                            </p>
                        {% endif %}
                    {% endif %}

                    <!-- Âå∫Âàá„ÇäÁ∑ö -->
                    <hr style="border: 0; border-top: 1px dashed rgba(0,0,0,0.15); margin: 15px 0; width: 100%;">

                    <!-- ÊâÄÊåÅ„ÇØ„É¨„Ç∏„ÉÉ„ÉàË°®Á§∫ -->
                    <div style="margin-bottom: 15px;">
                        <span style="font-size: 0.9em; color: var(--text-sub); font-weight: 600;">ÊâÄÊåÅ„ÇØ„É¨„Ç∏„ÉÉ„Éà</span><br>
                        <span style="font-size: 2.4em; font-weight: 800; color: var(--primary-color); line-height: 1;">{{ user.credits or 0 }}</span>
                        <span style="font-size: 1.1em; color: var(--primary-color); font-weight: 700;">CP</span>
                    </div>

                    <!-- „Éë„Çπ‰∫§Êèõ„Éú„Çø„É≥„Ç®„É™„Ç¢ -->
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <!-- 24ÊôÇÈñì„Éë„Çπ -->
                        <form action="{{ url_for('exchange_credits') }}" method="POST" style="margin: 0;">
                            <input type="hidden" name="plan" value="24h">
                            <button type="submit" class="btn" 
                                style="padding: 8px 14px; font-size: 0.9em; width: auto; background-color: #fff; color: var(--primary-color); border: 1px solid var(--primary-color); {% if (user.credits or 0) < 1 %}background-color: #f1f5f9; border-color: #cbd5e1; color: #94a3b8; cursor: not-allowed;{% endif %}" 
                                {% if (user.credits or 0) < 1 %}disabled{% endif %}>
                                24ÊôÇÈñì„Éë„Çπ (1CP)
                            </button>
                        </form>

                        <!-- Â≠¶Êúü„Éë„Çπ -->
                        <form action="{{ url_for('exchange_credits') }}" method="POST" style="margin: 0;">
                            <input type="hidden" name="plan" value="semester">
                            {% set earn_rate, exchange_cost = get_current_rates() %}
                            <button type="submit" class="btn" 
                                style="padding: 8px 14px; font-size: 0.9em; width: auto; {% if (user.credits or 0) < exchange_cost %}background-color: #f1f5f9; border-color: #cbd5e1; color: #94a3b8; cursor: not-allowed;{% else %}background-color: var(--primary-color); color: #fff; border: 1px solid var(--primary-color);{% endif %}" 
                                {% if (user.credits or 0) < exchange_cost %}disabled{% endif %}>
                                Â≠¶Êúü„Éë„Çπ ({{ exchange_cost }}CP)
                                {% if exchange_cost <= 2 %}
                                    <span style="background: #fff; color: #f43f5e; padding: 1px 5px; border-radius: 4px; font-size: 0.85em; margin-left: 4px; font-weight:800;">Êó©Ââ≤</span>
                                {% endif %}
                            </button>
                        </form>
                    </div>
                    
                    <p style="font-size: 0.8em; color: #94a3b8; margin: 12px 0 0 0;">‚ÄªË©≥Á¥∞„É¨„Éì„É•„ÉºÊäïÁ®ø„ÅßCP„ÇíÁç≤Âæó„Åß„Åç„Åæ„Åô</p>
                </div>

                <!-- Ê¥ªÂãï„Çπ„Çø„ÉÉ„ÉÑ -->
                <div class="stats-row" style="margin-bottom: 0;">
                    <div class="stat-item">
                        <span class="stat-value">{{ user.detailed_review_count }}</span>
                        <span class="stat-label">Ë©≥Á¥∞„É¨„Éì„É•„Éº</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">{{ user.quick_review_count }}</span>
                        <span class="stat-label">È´òÈÄü„É¨„Éì„É•„Éº</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">{{ user.badges|length }}</span>
                        <span class="stat-label">„Éê„ÉÉ„Ç∏</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ñº‚ñº‚ñº 2. „Éê„ÉÉ„Ç∏„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥ ‚ñº‚ñº‚ñº -->
        <section style="margin-bottom: 40px;">
            <div class="section-header">ÂÆüÁ∏æ„Éê„ÉÉ„Ç∏</div>
            <div class="badge-section" style="max-width: 100%; margin: 0; background: #fff; padding: 20px; border-radius: 16px; border: 1px solid #e2e8f0;">
                <div class="badge-container">
                    {% for badge in all_badges %}
                        {% if badge in user.badges %}
                            <div class="badge-item awarded">
                                <div class="badge-icon">{{ badge.icon }}</div>
                                <div class="badge-name">{{ badge.name }}</div>
                                <div class="badge-desc">{{ badge.description }}</div>
                            </div>
                        {% else %}
                            <div class="badge-item locked">
                                <div class="badge-icon">üîí</div>
                                <div class="badge-name">???</div>
                                <div class="badge-desc">{{ badge.description }}</div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </section>

        <!-- ‚ñº‚ñº‚ñº 3. ÊäïÁ®øÂ±•Ê≠¥ ‚ñº‚ñº‚ñº -->
        <section style="margin-bottom: 40px;">
            <div class="section-header">ÊäïÁ®øÂ±•Ê≠¥</div>
            <div style="background: #fff; padding: 20px; border-radius: 16px; border: 1px solid #e2e8f0;">
                {% if my_reviews_pagination.items %}
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
                            <thead>
                                <tr style="border-bottom: 2px solid #f1f5f9;">
                                    <th style="text-align: left; padding: 10px; color: var(--text-sub);">Ë¨õÁæ©Âêç</th>
                                    <th style="text-align: left; padding: 10px; color: var(--text-sub);">Á®ÆÈ°û</th>
                                    <th style="text-align: left; padding: 10px; color: var(--text-sub);">Ë©ï‰æ°</th>
                                    <th style="text-align: right; padding: 10px; color: var(--text-sub);">Êìç‰Ωú</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for review in my_reviews_pagination.items %}
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 12px 10px; font-weight: bold;">
                                        <a href="{{ url_for('course_view_detail', id=review.course.id) }}" style="color: var(--text-main); text-decoration: none;">
                                            {{ review.course.name }}
                                        </a>
                                    </td>
                                    <td style="padding: 12px 10px;">
                                        {% if review.is_quick %}
                                            <span style="font-size: 0.8em; background: #fff7ed; color: #c2410c; padding: 2px 8px; border-radius: 4px; border: 1px solid #ffedd5;">È´òÈÄü</span>
                                        {% else %}
                                            <span style="font-size: 0.8em; background: #f0fdf4; color: #15803d; padding: 2px 8px; border-radius: 4px; border: 1px solid #dcfce7;">Ë©≥Á¥∞</span>
                                        {% endif %}
                                    </td>
                                    <td style="padding: 12px 10px; color: var(--warning-color);">‚òÖ{{ "%.1f"|format(review.rating) }}</td>
                                    <td style="padding: 12px 10px; text-align: right;">
                                        <a href="{{ url_for('edit_review', review_id=review.id) }}" style="font-size: 0.9em; color: var(--primary-color); margin-right: 10px;">Á∑®ÈõÜ</a>
                                        <form action="{{ url_for('delete_review', review_id=review.id) }}" method="POST" style="display:inline;">
                                            <button type="submit" onclick="return confirm('Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü\nË©≥Á¥∞„É¨„Éì„É•„Éº„ÅÆÂ†¥Âêà„ÄÅÁç≤Âæó„Åó„ÅüCP„ÇÇÂõûÂèé„Åï„Çå„Åæ„Åô„ÄÇ');" style="background:none; border:none; color:var(--accent-color); font-size:0.9em; cursor:pointer; padding:0;">ÂâäÈô§</button>
                                        </form>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„É™„É≥„ÇØ„ÅÆËøΩÂä† -->
                    <div class="pagination" style="margin-top: 20px; display: flex; justify-content: center; gap: 5px;">
                        {% if my_reviews_pagination.has_prev %}
                            <a href="{{ url_for('mypage', page=my_reviews_pagination.prev_num) }}" class="btn-page" style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 5px; text-decoration: none; color: var(--text-main);">&laquo; Ââç„Å∏</a>
                        {% endif %}
                        
                        {% for p in my_reviews_pagination.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=1) %}
                            {% if p %}
                                {% if p == my_reviews_pagination.page %}
                                    <span class="current-page" style="font-weight:bold; padding: 5px 10px; border: 1px solid var(--primary-color); background: var(--primary-color); color: #fff; border-radius: 5px;">{{ p }}</span>
                                {% else %}
                                    <a href="{{ url_for('mypage', page=p) }}" class="btn-page" style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 5px; text-decoration: none; color: var(--text-main);">{{ p }}</a>
                                {% endif %}
                            {% else %}
                                <span class="ellipsis">...</span>
                            {% endif %}
                        {% endfor %}

                        {% if my_reviews_pagination.has_next %}
                            <a href="{{ url_for('mypage', page=my_reviews_pagination.next_num) }}" class="btn-page" style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 5px; text-decoration: none; color: var(--text-main);">Ê¨°„Å∏ &raquo;</a>
                        {% endif %}
                    </div>

                {% else %}
                    <p style="text-align: center; color: var(--text-sub); padding: 20px;">„Åæ„Å†ÊäïÁ®øÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                {% endif %}
            </div>
        </section>

        <!-- ‚ñº‚ñº‚ñº 4. „Éó„É≠„Éï„Ç£„Éº„É´Ë®≠ÂÆö (Áã¨Á´ã„Çª„ÇØ„Ç∑„Éß„É≥„Å®„Åó„Å¶ÈÖçÁΩÆ) ‚ñº‚ñº‚ñº -->
        <section style="max-width: 800px; margin: 0 auto 50px;">
            <div class="section-header">„Éó„É≠„Éï„Ç£„Éº„É´Ë®≠ÂÆö</div>
            
            <div class="profile-form-box">
                <form method="post">
                    <div class="form-row">
                        <div>
                            <label class="form-label-block">„É¶„Éº„Ç∂„ÉºÂêç</label>
                            <input type="text" name="username" placeholder="„É¶„Éº„Ç∂„ÉºÂêç" value="{{ user.username }}" required class="mb-0">
                        </div>
                        <div>
                            <label class="form-label-block">„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ <small>(Â§âÊõ¥‰∏çÂèØ)</small></label>
                            <input type="email" value="{{ user.email }}" disabled style="background-color: #f1f5f9; color: #64748b; margin-bottom: 0;">
                        </div>
                    </div>

                    <div class="form-row">
                        <div>
                            <label class="form-label-block">Â≠¶ÈÉ®</label>
                            <select name="faculty" required class="mb-0">
                                <option value="">--------</option>
                                <option value="Â∑•Â≠¶ÈÉ®" {% if user.faculty == 'Â∑•Â≠¶ÈÉ®' %}selected{% endif %}>Â∑•Â≠¶ÈÉ®</option>
                                <option value="ÁêÜÂ≠¶ÈÉ®" {% if user.faculty == 'ÁêÜÂ≠¶ÈÉ®' %}selected{% endif %}>ÁêÜÂ≠¶ÈÉ®</option>
                                <option value="ÂõΩÈöõÂú∞ÂüüÂâµÈÄ†Â≠¶ÈÉ®" {% if user.faculty == 'ÂõΩÈöõÂú∞ÂüüÂâµÈÄ†Â≠¶ÈÉ®' %}selected{% endif %}>ÂõΩÈöõÂú∞ÂüüÂâµÈÄ†Â≠¶ÈÉ®</option>
                                <option value="ÊïôËÇ≤Â≠¶ÈÉ®" {% if user.faculty == 'ÊïôËÇ≤Â≠¶ÈÉ®' %}selected{% endif %}>ÊïôËÇ≤Â≠¶ÈÉ®</option>
                                <option value="‰∫∫ÊñáÁ§æ‰ºöÂ≠¶ÈÉ®" {% if user.faculty == '‰∫∫ÊñáÁ§æ‰ºöÂ≠¶ÈÉ®' %}selected{% endif %}>‰∫∫ÊñáÁ§æ‰ºöÂ≠¶ÈÉ®</option>
                                <option value="Ëæ≤Â≠¶ÈÉ®" {% if user.faculty == 'Ëæ≤Â≠¶ÈÉ®' %}selected{% endif %}>Ëæ≤Â≠¶ÈÉ®</option>
                                <option value="ÂåªÂ≠¶ÈÉ®" {% if user.faculty == 'ÂåªÂ≠¶ÈÉ®' %}selected{% endif %}>ÂåªÂ≠¶ÈÉ®</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label-block">Â≠¶Áßë„Éª„Ç≥„Éº„Çπ</label>
                            <input type="text" name="department" placeholder="‰æã: Áü•ËÉΩÊÉÖÂ†±„Ç≥„Éº„Çπ" value="{{ user.department or '' }}" required class="mb-0">
                        </div>
                    </div>

                    <div class="form-row" style="grid-template-columns: 1fr;">
                        <div>
                            <label class="form-label-block">Â≠¶Âπ¥</label>
                            <select name="grade" required class="mb-0">
                                <option value="">--------</option>
                                <option value="1Âπ¥" {% if user.grade == '1Âπ¥' %}selected{% endif %}>1Âπ¥</option>
                                <option value="2Âπ¥" {% if user.grade == '2Âπ¥' %}selected{% endif %}>2Âπ¥</option>
                                <option value="3Âπ¥" {% if user.grade == '3Âπ¥' %}selected{% endif %}>3Âπ¥</option>
                                <option value="4Âπ¥" {% if user.grade == '4Âπ¥' %}selected{% endif %}>4Âπ¥</option>
                                <option value="‰øÆÂ£´1Âπ¥" {% if user.grade == '‰øÆÂ£´1Âπ¥' %}selected{% endif %}>‰øÆÂ£´1Âπ¥</option>
                                <option value="‰øÆÂ£´2Âπ¥" {% if user.grade == '‰øÆÂ£´2Âπ¥' %}selected{% endif %}>‰øÆÂ£´2Âπ¥</option>
                                <option value="ÂçöÂ£´ÂæåÊúü" {% if user.grade == 'ÂçöÂ£´ÂæåÊúü' %}selected{% endif %}>ÂçöÂ£´ÂæåÊúü</option>
                                <option value="„Åù„ÅÆ‰ªñ" {% if user.grade == '„Åù„ÅÆ‰ªñ' %}selected{% endif %}>„Åù„ÅÆ‰ªñ</option>
                            </select>
                        </div>
                    </div>

                    <div style="margin-top: 30px; display: flex; gap: 20px; align-items: center; justify-content: center;">
                        <a href="{{ url_for('index') }}" class="btn-cancel" style="width: auto; min-width: 120px; text-align: center;">Êàª„Çã</a>
                        <button type="submit" class="btn" style="width: auto; min-width: 200px;">Â§âÊõ¥„Çí‰øùÂ≠ò„Åô„Çã</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- ‚ñº‚ñº‚ñº 5. „Éë„Çπ„ÉØ„Éº„ÉâÂ§âÊõ¥ (Áã¨Á´ã„Çª„ÇØ„Ç∑„Éß„É≥) ‚ñº‚ñº‚ñº -->
        <section style="max-width: 800px; margin: 0 auto 50px;">
            <div class="section-header">„Éë„Çπ„ÉØ„Éº„ÉâÂ§âÊõ¥</div>
            
            <div class="profile-form-box">
                <form method="post" action="{{ url_for('change_password') }}">
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label-block">ÁèæÂú®„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ</label>
                        <div class="password-wrapper">
                            <input type="password" name="current_password" id="current_password" placeholder="ÁèæÂú®„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ" required style="margin-bottom: 0;">
                            <button type="button" class="toggle-password-btn" onclick="togglePassword('current_password', this)" title="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíË°®Á§∫">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-row">
                        <div>
                            <label class="form-label-block">Êñ∞„Åó„ÅÑ„Éë„Çπ„ÉØ„Éº„Éâ</label>
                            <div class="password-wrapper">
                                <input type="password" name="new_password" id="new_password" placeholder="Êñ∞„Åó„ÅÑ„Éë„Çπ„ÉØ„Éº„Éâ" required 
                                       pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{12,}$"
                                       title="„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ12ÊñáÂ≠ó‰ª•‰∏ä„Åß„ÄÅÂ§ßÊñáÂ≠ó„ÄÅÂ∞èÊñáÂ≠ó„ÄÅÊï∞Â≠ó„Çí„Åù„Çå„Åû„Çå1ÊñáÂ≠ó‰ª•‰∏äÂê´„ÇÅ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ" style="margin-bottom: 0;">
                                <button type="button" class="toggle-password-btn" onclick="togglePassword('new_password', this)" title="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíË°®Á§∫">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </button>
                            </div>
                            <p style="font-size: 0.8em; color: var(--text-sub); margin-top: 5px;">‚Äª 12ÊñáÂ≠ó‰ª•‰∏ä„ÄÅÂ§ßÊñáÂ≠ó„ÉªÂ∞èÊñáÂ≠ó„ÉªÊï∞Â≠ó„ÇíÂê´„ÇÄ</p>
                        </div>
                        <div>
                            <label class="form-label-block">Êñ∞„Åó„ÅÑ„Éë„Çπ„ÉØ„Éº„ÉâÔºàÁ¢∫Ë™çÔºâ</label>
                            <div class="password-wrapper">
                                <input type="password" name="new_password_confirm" id="new_password_confirm" placeholder="Êñ∞„Åó„ÅÑ„Éë„Çπ„ÉØ„Éº„ÉâÔºàÁ¢∫Ë™çÔºâ" required style="margin-bottom: 0;">
                                <button type="button" class="toggle-password-btn" onclick="togglePassword('new_password_confirm', this)" title="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíË°®Á§∫">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 30px; display: flex; gap: 20px; align-items: center; justify-content: center;">
                        <button type="submit" class="btn" style="width: auto; min-width: 200px;">„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂ§âÊõ¥„Åô„Çã</button>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <script>
    function togglePassword(inputId, btn) {
        const input = document.getElementById(inputId);
        const icon = btn.querySelector('svg');
        
        if (input.type === "password") {
            input.type = "text";
            // „Ç¢„Ç§„Ç≥„É≥„Çí„ÄåÈùûË°®Á§∫ÔºàÊñúÁ∑ö‰ªò„ÅçÁõÆÔºâ„Äç„Å´Â§âÊõ¥
            icon.innerHTML = '<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line>';
            btn.title = "„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÈö†„Åô";
        } else {
            input.type = "password";
            // „Ç¢„Ç§„Ç≥„É≥„Çí„ÄåË°®Á§∫ÔºàÁõÆÔºâ„Äç„Å´Êàª„Åô
            icon.innerHTML = '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>';
            btn.title = "„Éë„Çπ„ÉØ„Éº„Éâ„ÇíË°®Á§∫";
        }
    }
    </script>
</body>
</html>